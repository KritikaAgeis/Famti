<odoo>
    <record id="mrp_production_form_inherit_serial" model="ir.ui.view">
        <field name="name">mrp.production.form.serial.rename</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
        <field name="arch" type="xml">

            <xpath expr="//form/header" position="inside">
                <button
                    name="action_open_split_lots_wizard"
                    type="object"
                    string="Split Lots"
                    class="btn-primary"
                    invisible="state not in ['confirmed','progress','to_close']"
                />
            </xpath>

            <xpath expr="//button[@name='action_start']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            
            <xpath expr="//field[@name='lot_producing_id']" position="attributes">
                <attribute name="string">Serial Number</attribute>
                <attribute name="invisible">mo_serial_no != 1</attribute>
            </xpath>

            <xpath expr="//label[@for='lot_producing_id']" position="attributes">
                <attribute name="invisible">mo_serial_no != 1</attribute>
            </xpath>
            <xpath expr="//button[@name='action_generate_serial']" position="attributes">
                <attribute name="invisible">mo_serial_no != 1</attribute>
            </xpath>
            
            <xpath expr="//field[@name='product_id']" position="after">
                <field name="product_code"/>
            </xpath>

            <xpath expr="//page[@name='finished_products']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//notebook" position="inside">
                <page string="Serial / Batch Details">
                    <field name="serial_line_ids">
                        <list editable="bottom">
                            <field name="serial_number"/>
                            <field name="mo_product_code"/>
                            <field name="po_product_code"/>
                            <field name="location_id"/>
                            <field name="thickness" optional="hide" required="1"/>
                            <field name="thickness_uom" optional="hide"/>
                            <field name="width" optional="hide" required="1"/>
                            <field name="width_uom" optional="hide"/>
                            <field name="core_id" optional="hide" />
                            <field name="length" optional="hide" required="1"/>
                            <field name="length_uom" optional="hide"/>
                            <field name="total_input"/>
                            <!-- <field name="total_output"/> -->
                            <field name="quantity" string="Output"/>
                            <field name="uom_id"/>
                            <field name="total_scrap"/>
                            <field name="grade_type"/>
                        </list>
                    </field>
                </page>
                <page string="Scrap Details">
                    <field name="scrap_line_ids">
                        <list editable="bottom">
                            <field name="serial_number"/>
                            <field name="source_location_id"/>
                            <field name="location_id"/>
                            <field name="thickness" optional="hide"/>
                            <field name="thickness_uom" optional="hide"/>
                            <field name="width" optional="hide"/>
                            <field name="width_uom" optional="hide"/>
                            <field name="core_id" optional="hide"/>
                            <field name="length" optional="hide"/>
                            <field name="length_uom" optional="hide"/>
                            <field name="quantity"/>
                            <field name="uom_id"/>
                            <field name="scrap_reason_tag_ids" widget="many2many_tags" optional="hide"/>  
                        </list>
                    </field>
                </page>

            </xpath>

            <xpath expr="//page[@name='components']" position="replace">
                <page name="components" string="Components">
                    <field name="raw_material_move_ids" widget="stock_move_one2many" context="{'default_date': date_start, 'default_date_deadline': date_start, 'default_location_id': location_src_id, 'default_location_dest_id': production_location_id, 'default_warehouse_id': warehouse_id, 'default_state': 'draft', 'default_raw_material_production_id': id, 'default_picking_type_id': picking_type_id, 'default_company_id': company_id, 'form_view_ref': 'mrp.view_mrp_stock_move_operations', 'active_mo_id': id}" readonly="state == 'cancel' or (state == 'done' and is_locked)">
                        <list default_order="is_done, manual_consumption desc, sequence" editable="bottom">
                            <control>
                                <create string="Add a line"/>
                                <button name="action_add_from_catalog_raw" string="Catalog" type="object" class="px-4 btn-link" context="{'order_id': parent.id}"/>
                            </control>
                            <field name="product_id" force_save="1" context="{'default_is_storable': True}" required="1" readonly="move_lines_count &gt; 0 or state == 'cancel' or (state != 'draft' and not additional)" domain="['&amp;', ('type', '=', 'consu'), ('id', '!=', parent.product_id)]"/>
                            <field name="location_id" string="From" readonly="1" force_save="1" groups="stock.group_stock_multi_locations" optional="show"/>
                            <!-- test_immediate_validate_uom_2, test_product_produce_different_uom -->
                            <field name="product_uom" column_invisible="True"/>
                            <field name="propagate_cancel" column_invisible="True"/>
                            <field name="price_unit" column_invisible="True"/>
                            <field name="company_id" column_invisible="True"/>
                            <field name="product_uom_category_id" column_invisible="True"/>
                            <field name="name" column_invisible="True"/>
                            <field name="allowed_operation_ids" column_invisible="True"/>
                            <field name="unit_factor" column_invisible="True"/>
                            <field name="date_deadline" column_invisible="True" force_save="1"/>
                            <field name="date" column_invisible="True"/>
                            <field name="additional" column_invisible="True"/>
                            <field name="picking_type_id" column_invisible="True"/>
                            <field name="is_storable" column_invisible="True"/>
                            <field name="has_tracking" column_invisible="True"/>
                            <field name="operation_id" column_invisible="True"/>
                            <field name="is_done" column_invisible="True"/>
                            <field name="bom_line_id" column_invisible="True"/>
                            <field name="sequence" column_invisible="True"/>
                            <field name="warehouse_id" column_invisible="True"/>
                            <field name="is_locked" column_invisible="True"/>
                            <field name="move_lines_count" column_invisible="True"/>
                            <field name="location_dest_id" domain="[('id', 'child_of', parent.location_dest_id)]" column_invisible="True"/>
                            <field name="state" column_invisible="True" force_save="1"/>
                            <field name="should_consume_qty" column_invisible="True"/>
                            <field name="product_uom_qty" force_save="1" string="To Consume" column_invisible="not parent.show_produce_all" readonly="parent.state != 'draft' and ((parent.state not in ('confirmed', 'progress', 'to_close') and not parent.is_planned) or (parent.is_locked and state != 'draft'))"/>
                            <field name="product_uom_qty" widget="mrp_should_consume" force_save="1" string="To Consume" column_invisible="parent.show_produce_all" readonly="parent.state != 'draft' and ((parent.state not in ('confirmed', 'progress', 'to_close') and not parent.is_planned) or (parent.is_locked and state != 'draft'))"/>
                            <field name="product_qty" readonly="1" column_invisible="True"/>
                            <field name="forecast_expected_date" column_invisible="True"/>
                            <!-- Button are used in state draft to doesn't have the name of the column "Reserved"-->
                            <button type="object" name="action_product_forecast_report" title="Forecast Report" icon="fa-area-chart" column_invisible="parent.state != 'draft'" invisible="forecast_availability &lt; 0"/>
                            <button type="object" name="action_product_forecast_report" title="Forecast Report" icon="fa-area-chart text-danger" column_invisible="parent.state != 'draft'" invisible="forecast_availability &gt;= 0"/>
                            <!-- TODO put forecast back -->
                            <field name="forecast_availability" column_invisible="parent.state in ['done', 'cancel']" string="Forecast" widget="forecast_widget" optional="hide"/>
                            <field name="quantity" string="Quantity" decoration-success="not is_done and (quantity - (should_consume_qty if parent.qty_producing else product_uom_qty) == 0)" decoration-warning="not is_done and (quantity - (should_consume_qty if parent.qty_producing else product_uom_qty) &gt; 0.0001)" column_invisible="parent.state == 'draft'" decoration-info="manual_consumption" decoration-bf="manual_consumption" readonly="has_tracking != 'none'" force_save="1"/>
                            <field name="product_uom" readonly="state != 'draft' and id" options="{'no_open': True, 'no_create': True}" groups="uom.group_uom"/>
                            <field name="picked" string="Consumed" column_invisible="parent.state == 'draft'" optional="show"/>
                            <field name="manual_consumption" column_invisible="True" force_save="1"/>
                            <field name="show_details_visible" column_invisible="True"/>
                            <field name="lot_ids" widget="many2many_tags" optional="hide" string="Lot/Serial Numbers" help="Displays the consumed Lot/Serial Numbers." groups="stock.group_production_lot" readonly="1" column_invisible="not parent.show_lot_ids or parent.state == 'draft'" invisible="not show_details_visible" options="{'create': [('parent.use_create_components_lots', '!=', False)]}" context="{'default_product_id': product_id}" domain="[('product_id','=',product_id)]"/>
                            <field name="group_id" column_invisible="True"/>
                        </list>
                    </field>
                </page>
            </xpath>

            <xpath expr="//page[@name='components']" position="after">
                <page string="Consumables">
                    <field name="consumable_move_ids" widget="stock_move_one2many" context="{'default_date': date_start, 'default_date_deadline': date_start, 'default_location_id': location_src_id, 'default_location_dest_id': production_location_id, 'default_warehouse_id': warehouse_id, 'default_state': 'draft', 'default_raw_material_production_id': id, 'default_picking_type_id': picking_type_id, 'default_company_id': company_id, 'form_view_ref': 'mrp.view_mrp_stock_move_operations', 'active_mo_id': id}" readonly="state == 'cancel' or (state == 'done' and is_locked)">
                        <list default_order="is_done, manual_consumption desc, sequence" editable="bottom">
                            <control>
                                <create string="Add a line"/>
                                <button name="action_add_from_catalog_raw" string="Catalog" type="object" class="px-4 btn-link" context="{'order_id': parent.id}"/>
                            </control>
                            <field name="product_id" force_save="1" context="{'default_is_storable': True}" required="1" readonly="move_lines_count &gt; 0 or state == 'cancel' or (state != 'draft' and not additional)" domain="['&amp;', ('type', '=', 'consu'), ('id', '!=', parent.product_id)]"/>
                            <field name="location_id" string="From" force_save="1" groups="stock.group_stock_multi_locations" optional="show"/>
                            <!-- test_immediate_validate_uom_2, test_product_produce_different_uom -->
                            <field name="product_uom" column_invisible="True"/>
                            <field name="propagate_cancel" column_invisible="True"/>
                            <field name="price_unit" column_invisible="True"/>
                            <field name="company_id" column_invisible="True"/>
                            <field name="product_uom_category_id" column_invisible="True"/>
                            <field name="name" column_invisible="True"/>
                            <field name="allowed_operation_ids" column_invisible="True"/>
                            <field name="unit_factor" column_invisible="True"/>
                            <field name="date_deadline" column_invisible="True" force_save="1"/>
                            <field name="date" column_invisible="True"/>
                            <field name="additional" column_invisible="True"/>
                            <field name="picking_type_id" column_invisible="True"/>
                            <field name="is_storable" column_invisible="True"/>
                            <field name="has_tracking" column_invisible="True"/>
                            <field name="operation_id" column_invisible="True"/>
                            <field name="is_done" column_invisible="True"/>
                            <field name="bom_line_id" column_invisible="True"/>
                            <field name="sequence" column_invisible="True"/>
                            <field name="warehouse_id" column_invisible="True"/>
                            <field name="is_locked" column_invisible="True"/>
                            <field name="move_lines_count" column_invisible="True"/>
                            <field name="location_dest_id" domain="[('id', 'child_of', parent.location_dest_id)]" column_invisible="True"/>
                            <field name="state" column_invisible="True" force_save="1"/>
                            <field name="should_consume_qty" column_invisible="True"/>
                            <field name="product_uom_qty" force_save="1" string="To Consume" column_invisible="not parent.show_produce_all" readonly="parent.state != 'draft' and ((parent.state not in ('confirmed', 'progress', 'to_close') and not parent.is_planned) or (parent.is_locked and state != 'draft'))"/>
                            <field name="product_uom_qty" widget="mrp_should_consume" force_save="1" string="To Consume" column_invisible="parent.show_produce_all" readonly="parent.state != 'draft' and ((parent.state not in ('confirmed', 'progress', 'to_close') and not parent.is_planned) or (parent.is_locked and state != 'draft'))"/>
                            <field name="product_qty" readonly="1" column_invisible="True"/>
                            <field name="forecast_expected_date" column_invisible="True"/>
                            <!-- Button are used in state draft to doesn't have the name of the column "Reserved"-->
                            <button type="object" name="action_product_forecast_report" title="Forecast Report" icon="fa-area-chart" column_invisible="parent.state != 'draft'" invisible="forecast_availability &lt; 0"/>
                            <button type="object" name="action_product_forecast_report" title="Forecast Report" icon="fa-area-chart text-danger" column_invisible="parent.state != 'draft'" invisible="forecast_availability &gt;= 0"/>
                            <!-- TODO put forecast back -->
                            <field name="forecast_availability" column_invisible="parent.state in ['done', 'cancel']" string="Forecast" widget="forecast_widget" optional="hide"/>
                            <field name="quantity" string="Quantity" decoration-success="not is_done and (quantity - (should_consume_qty if parent.qty_producing else product_uom_qty) == 0)" decoration-warning="not is_done and (quantity - (should_consume_qty if parent.qty_producing else product_uom_qty) &gt; 0.0001)" column_invisible="parent.state == 'draft'" decoration-info="manual_consumption" decoration-bf="manual_consumption" readonly="has_tracking != 'none'" force_save="1"/>
                            <field name="product_uom" readonly="state != 'draft' and id" options="{'no_open': True, 'no_create': True}" groups="uom.group_uom"/>
                            <field name="picked" string="Consumed" column_invisible="parent.state == 'draft'" optional="show"/>
                            <field name="manual_consumption" column_invisible="True" force_save="1"/>
                            <field name="show_details_visible" column_invisible="True"/>
                            <field name="lot_ids" widget="many2many_tags" optional="hide" string="Lot/Serial Numbers" help="Displays the consumed Lot/Serial Numbers." groups="stock.group_production_lot" readonly="1" column_invisible="not parent.show_lot_ids or parent.state == 'draft'" invisible="not show_details_visible" options="{'create': [('parent.use_create_components_lots', '!=', False)]}" context="{'default_product_id': product_id}" domain="[('product_id','=',product_id)]"/>
                            <field name="group_id" column_invisible="True"/>
                        </list>
                    </field>
                </page>
            </xpath>
            
            <xpath expr="//page[@name='miscellaneous']//field[@name='location_src_id'][1]" position="after">
                <field name="scrap_location_id"
                    domain="[('scrap_location', '=', True)]"
                    options="{'no_create': True}"
                    readonly="state != 'draft'"/>
            </xpath>
        </field>
    </record>


<!--    <record id="mrp_workcenter_form_inherit_serial" model="ir.ui.view">-->
<!--        <field name="name">mrp.workcenter.form</field>-->
<!--        <field name="model">mrp.workcenter</field>-->
<!--        <field name="inherit_id" ref="mrp.mrp_workcenter_view"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//field[@name='code']" position="after">-->
<!--                <attribute name="serial_code">Serial Number</attribute>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->



</odoo>
